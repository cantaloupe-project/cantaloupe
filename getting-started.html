<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Extensible image server in Java
">

  <link rel="stylesheet" href="/cantaloupe/css/base.css">

  <title>Cantaloupe</title>
</head>


  <body>

    <div class="container-fluid">

      <div class="clearfix">
        <header>
  <a href="/cantaloupe/">
    <img src="images/cantaloupe.jpg" width="154" height="81">
  </a>
  <h1>
    <a href="/cantaloupe/">Cantaloupe</a>
    <br>
    <small>Extensible IIIF Image API 2.0 image server in Java</small>
  </h1>
</header>

      </div>

      <div class="row">
        <div class="col-sm-3">
          <nav id="toc">
  <ul>
    <li><a href="/cantaloupe/">Home</a>
      <ul>
        <li><a href="/cantaloupe/#About">About</a></li>
        <li><a href="/cantaloupe/#Features">Features</a></li>
        <li><a href="/cantaloupe/#Download">Download</a></li>
      </ul>
    </li>
    <li>
      <a href="getting-started.html">Getting Started</a>
      <ul>
        <li><a href="getting-started.html#Requirements">Requirements</a></li>
        <li><a href="getting-started.html#Configuration">Configuration</a></li>
        <li><a href="getting-started.html#Running">Running</a></li>
        <li><a href="getting-started.html#Upgrading">Upgrading</a></li>
        <li><a href="getting-started.html#Proxying">Proxying</a></li>
        <li><a href="getting-started.html#Considerations">Considerations</a></li>
      </ul>
    </li>
    <li>
      <a href="resolvers.html">Resolvers</a>
      <ul>
        <li><a href="resolvers.html#FilesystemResolver">Filesystem</a></li>
        <li><a href="resolvers.html#HttpResolver">HTTP</a></li>
        <li><a href="resolvers.html#JdbcResolver">JDBC</a></li>
        <li><a href="resolvers.html#AmazonS3Resolver">Amazon S3</a></li>
      </ul>
    </li>
    <li>
      <a href="processors.html">Processors</a>
      <ul>
        <li><a href="processors.html#Java2dProcessor">Java 2D</a></li>
        <li><a href="processors.html#GraphicsMagickProcessor">GraphicsMagick</a></li>
        <li><a href="processors.html#ImageMagickProcessor">ImageMagick</a></li>
        <li><a href="processors.html#KakaduProcessor">Kakadu</a></li>
        <li><a href="processors.html#JaiProcessor">JAI</a></li>
        <li><a href="processors.html#FfmpegProcessor">FFmpeg</a></li>
        <li><a href="processors.html#Compatibility">Compatibility</a></li>
      </ul>
    </li>
    <li>
      <a href="caches.html">Caches</a>
      <ul>
        <li><a href="caches.html#FilesystemCache">Filesystem</a></li>
        <li><a href="caches.html#JdbcCache">JDBC</a></li>
        <li><a href="caches.html#Flushing">Flushing</a></li>
        <li><a href="caches.html#Considerations">Considerations</a></li>
      </ul>
    </li>
    <li><a href="access-control.html">Access Control</a></li>
    <li><a href="client-caching.html">Client-Side Caching</a></li>
    <li>
      <a href="logging.html">Logging</a>
      <ul>
        <li><a href="logging.html#Application%20Log">Application Log</a></li>
        <li><a href="logging.html#Access%20Log">Access Log</a></li>
      </ul>
    </li>
    <li>
      <a href="source-formats.html">Source Formats</a>
      <ul>
        <li><a href="source-formats.html#JPEG">JPEG</a></li>
        <li><a href="source-formats.html#JPEG2000">JPEG2000</a></li>
        <li><a href="source-formats.html#TIFF">TIFF</a></li>
      </ul>
    </li>
    <li>
      <a href="developers.html">Developer's Guide</a>
      <ul>
        <li><a href="developers.html#Resolvers">Custom Resolvers</a></li>
        <li><a href="developers.html#Processors">Custom Processors</a></li>
        <li><a href="developers.html#Caches">Custom Caches</a></li>
        <li><a href="/cantaloupe/javadoc/">Javadoc</a></li>
        <li><a href="developers.html#Contributing">Contributing</a></li>
        <li><a href="developers.html#Administrative">Administrative</a></li>
      </ul>
    </li>
    <li><a href="changes.html">Change Log</a>
  </ul>
</nav>

        </div> <!-- .col-sm-3 -->

        <div class="col-sm-9">
          <h2>Getting Started</h2>

<h3 id="Requirements">Requirements</h3>

<p>The only hard requirement is Java 7+. Particular <a href="processors.html">processors</a> may have additional requirements.</p>

<h3 id="Configuration">Configuration</h3>

<p>Cantaloupe comes bundled with a sample configuration file, named <span class="filename">cantaloupe.properties.sample</span>. <strong>Do not edit this file</strong> &mdash; instead, create a copy and edit that. (These instructions assume a name of <span class="filename">cantaloupe.properties</span>, but any name will work.)</p>

<h3 id="Running">Running</h3>

<p>From the command prompt:</p>

<pre>$ java -Dcantaloupe.config=/path/to/cantaloupe.properties -Xmx2g -jar Cantaloupe-x.x.x.jar</pre>

<p>Assuming the <code>http.port</code> option has not been changed, it is now running at: <a href="http://localhost:8182/iiif">http://localhost:8182/iiif</a></p>

<p>Note: <code>-Xmx2g</code> tells the JVM to use up to 2GB of heap space (RAM). Without this argument, some JVMs will default to a much smaller amount, leading to OutOfMemoryErrors.</p>

<p><em>Note: On OS X, a "java" icon will appear in the Dock while Cantaloupe is running. This can be disabled by adding <code>-Djava.awt.headless=true</code> to the command.</em></p>

<h3 id="Upgrading">Upgrading</h3>

<p>Upgrading is usually just a matter of downloading a new version and running it. Since instances are self-contained, new versions can run happily alongside existing ones, with each using its own config file. Sometimes there are backwards-incompatible changes to the configuration file structure, though, so check below to see if there is anything more to be done.</p>

<h4>1.2 to 1.2.1</h4>

<p>Nothing to do.</p>

<h4>1.1 to 1.2</h4>

<ul>
  <li>Add the <code>http.content_disposition</code> key from the sample configuration.</li>
  <li>Add the <code>AmazonS3Resolver.*</code> keys from the sample configuration.</li>
  <li>Add the <code>FfmpegProcessor.path_to_binaries</code> key from the sample configuration.</li>
  <li>Add the <code>cache.server.resolve_first</code> key from the sample configuration.</li>
  <li>Remove the <code>generate_https_links</code> key from your configuration file, and add the <code>base_uri</code> key from the sample configuration.</li>
</ul>

<h4>1.0.x to 1.1</h4>

<ul>
  <li>Add the <code>cache.client.enabled</code> key from the sample configuration.</li>
</ul>

<h4>1.0-beta3 to 1.0</h4>

<ul>
  <li>Add the <code>logging.*</code> keys from the sample configuration.</li>
  <li>Add the <code>generate_https_links</code> key from the sample configuration.</li>
  <li>Add the <code>FfmpegProcessor.path_to_binaries</code> key from the sample configuration.
  <li>Rename <code>HttpResolver.username</code> to <code>HttpResolver.auth.basic.username</code> in the configuration.</li>
  <li>Rename <code>HttpResolver.password</code> to <code>HttpResolver.auth.basic.secret</code> in the
  configuration.</li>
</ul>

<h4>1.0-beta2 to 1.0-beta3</h4>

<ul>
  <li>Rename the <code>cache</code> key in the configuration to <code>cache.server</code>.</li>
  <li>Add the <code>cache.client.*</code> keys from the sample configuration.</li>
  <li>Add the <code>http.auth.basic*</code> keys from the sample configuration.</li>
  <li>Add the <code>KakaduProcessor</code> keys from the sample configuration.</li>
  <li>Change any <code>ImageIoProcessor</code> references to <code>Java2dProcessor</code> in the configuration.</li>
  <li>Add the <code>Java2dProcessor.tif.reader</code> key from the sample configuration.</li>
</ul>

<h4>1.0-beta1 to 1.0-beta2</h4>

<ul>
  <li>Add the <code>cache</code> and <code>FilesystemCache.*</code> keys from the sample configuration.</li>
  <li>Add the <code>FilesystemResolver.path_separator</code> and <code>HttpResolver.path_separator</code> keys from the sample configuration.</li>
</ul>

<h3 id="Proxying">Proxying</h3>

<p>Cantaloupe can be reverse-proxied behind another web server like Apache or nginx. The following example should be able to get you most of the way toward a working Apache reverse proxy. This assumes that Cantaloupe is running on a server called <span class="filename">images.example.org</span> on port 8182; the reverse proxy is running on <span class="filename">www.example.org</span>; and Cantaloupe is to be made available at the <span class="filename">/cantaloupe</span> base path.</p>

<p>First, set <code>base_uri</code> in the Cantaloupe configuration file to the publicly-visible base URI:

<pre>base_uri = http://www.example.org/cantaloupe</pre>

<p>Then, add something like the following to your Apache reverse proxy configuration:</p>

<pre>&lt;VirtualHost *:80&gt;
    ServerName www.example.org
    ProxyPass /cantaloupe/ http://images.example.org:8182/
    ProxyPassReverse /cantaloupe/ http://images.example.org:8182/
    ProxyPassReverseCookiePath / /
    ProxyPassReverseCookieDomain images.example.org:8182 localhost
&lt;/VirtualHost&gt;
</pre>

<p><span class="filename">http://www.example.org/cantaloupe/iiif</span> now displays the Cantaloupe landing page.</p>

<h3 id="Considerations">Considerations</h3>

<h4>CPU</h4>

<p>Generally, response times benefit from multiple fast CPU cores. Even if a particular processor doesn't support multithreading, the operating system is at least likely to schedule different processing threads (from simultaneous requests) on different cores.</p>

<p>A 64-bit CPU is also important, as it enables Cantaloupe to use more memory.</p>

<h4 id="Memory">Memory</h4>

<p>Consider the case of an image server that is asked to render tiles for a 4096x4096 pixel source image that, at 24 bits per pixel, totals 50MB in
decompressed size. Multiple clients are simultaneously requesting numerous downscaled tiles. Request handlers do not communicate with each other, so each one is loading this large image and operating on it independently.</p>

<p>Furthermore, some processors are inefficient in that they have to create new images internally at each intermediate step in the processing pipeline (cropping, scaling, rotating, etc.). Each one occupies precious memory.</p>

<p>It's easy to see where RAM becomes a major consideration here. With the processors that do their work in Java, It is completely normal to see transient spikes of hundreds of megabytes of memory use on the Java heap in response to a single zooming-image-viewer request. The JVM will accommodate by dynamically increasing the heap size. From the operating system's perspective, the process is bloating up to a gigabyte in size and beyond, but there is nothing wrong &mdash; most of this is actually unused heap space.</p>

<p>The smaller the available heap space, the larger the source images, and the larger the number of simultaneous requests, the greater the likelihood of OutOfMemoryErrors. In production, it is highly recommended to use the <code>-Xmx</code> flag to increase the maximum heap size to the largest amount possible &mdash; for example, <code>-Xmx8g</code> for 8GB. And, by all means, use caching liberally on both the <a href="client-caching.html">client</a> and <a href="caches.html">server</a>.</p>

<h4>Storage</h4>

<p>Cantaloupe benefits from fast read performance in the underlying storage system, especially as source image size increases.</p>

        </div>
      </div>

      <footer>
</footer>


    </div>

  </body>

</html>
